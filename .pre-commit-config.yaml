# Pre-commit configuration for Thoth project
# See https://pre-commit.com for more information
#
# This config mirrors the GitHub Actions CI workflow:
# - Lint & Format: ruff check, ruff format
# - Type Check: mypy
# - Security: bandit
# - Tests: pytest
#
# Usage:
#   pre-commit run --all-files    # Full CI suite (lint + type check + security + tests)
#   pre-commit run ruff-check     # Run specific hook only
#
# For faster commits (skip tests), use:
#   SKIP=pytest git commit -m "message"

default_stages:
  - pre-commit
minimum_pre_commit_version: 3.0.0

repos:

  # Type Check
  - repo: local
    hooks:
      - id: type-check
        name: type-check
        entry: hatch run dev:typecheck
        language: system
        types:
          - python
        require_serial: true
        pass_filenames: false

  # Ruff - Fast Python linter and formatter (managed by hatch)
  - repo: local
    hooks:
      - id: ruff-format
        name: ruff-format
        entry: hatch run lint:ruff format
        language: system
        types:
          - python
        require_serial: true
      - id: ruff-check
        name: ruff-check
        entry: hatch run lint:ruff check --fix
        language: system
        types:
          - python
        require_serial: true

  # mypy - Static type checker (managed by hatch)
  - repo: local
    hooks:
      - id: mypy
        name: mypy
        entry: hatch run lint:mypy thoth
        language: system
        types:
          - python
        require_serial: true
        pass_filenames: false

  # Bandit - Security linting (managed by hatch)
  - repo: local
    hooks:
      - id: bandit
        name: bandit
        entry: hatch run lint:bandit -r thoth
        language: system
        types:
          - python
        require_serial: true
        pass_filenames: false

  # pytest - Unit tests
  - repo: local
    hooks:
      - id: pytest
        name: pytest
        entry: hatch test
        language: system
        types:
          - python
        pass_filenames: false

# CI configuration
ci:
  autofix_commit_msg: |
    [pre-commit.ci] auto fixes from pre-commit hooks

    for more information, see https://pre-commit.ci
  autofix_prs: true
  autoupdate_branch: ''
  autoupdate_commit_msg: '[pre-commit.ci] pre-commit autoupdate'
  autoupdate_schedule: weekly
  skip:
    - pytest
    # Skip tests in CI (they run separately in GitHub Actions)
  submodules: false